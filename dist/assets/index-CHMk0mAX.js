var A=Object.defineProperty;var y=t=>{throw TypeError(t)};var E=(t,e,n)=>e in t?A(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var f=(t,e,n)=>E(t,typeof e!="symbol"?e+"":e,n),L=(t,e,n)=>e.has(t)||y("Cannot "+n);var l=(t,e,n)=>(L(t,e,"read from private field"),n?n.call(t):e.get(t)),h=(t,e,n)=>e.has(t)?y("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),p=(t,e,n,a)=>(L(t,e,"write to private field"),a?a.call(t,n):e.set(t,n),n);var C=(t,e,n,a)=>({set _(i){p(t,e,i,n)},get _(){return l(t,e,a)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&a(r)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function S(t,e,n){const a=[];for(let i=0;i<t;i++)a.push(new Array(e).fill(n));return a}function w(t,e){let n=0,a=0;do n=Math.floor(Math.random()*t.length),a=Math.floor(Math.random()*t[n].length);while(!e(t[n][a]));return[n,a]}function O(t,e){return t.map((n,a)=>n.map((i,s)=>e(i,[a,s])))}function F(t,e){return t.forEach((n,a)=>n.forEach((i,s)=>e(i,[a,s])))}function*b(t,e,n){const a=Math.min(e+2,t.length);for(let i=Math.max(e-1,0);i<a;i++){const s=Math.min(n+2,t[i].length);for(let r=Math.max(n-1,0);r<s;r++)yield t[i][r]}}var c;class j{constructor(){h(this,c,[])}add(e){l(this,c).push(e)}remove(e){l(this,c).splice(l(this,c).indexOf(e),1)}invoke(...e){l(this,c).forEach(n=>n.apply(null,e))}}c=new WeakMap;var g,m,v;class T{constructor(e){f(this,"isMine",!1);f(this,"adjacentTiles",[]);h(this,g,0);h(this,m,!1);h(this,v,!1);f(this,"onReveal",new j);f(this,"onFlagStateChanged",new j);this.isMine=e}get adjacentMineCount(){return l(this,g)}get isRevealed(){return l(this,m)}get isFlagged(){return l(this,v)}set isFlagged(e){this.canBeFlagged&&(p(this,v,e),this.onFlagStateChanged.invoke())}get canBeFlagged(){return!this.isRevealed}get canBeRevealed(){return!this.isRevealed&&!this.isFlagged}get canBeAutoRevealed(){return this.canBeRevealed&&!this.isMine}get canAutoRevealOthers(){return!this.isMine&&this.adjacentMineCount===0}addAdjacentTile(e){this.adjacentTiles.push(e),e.isMine&&C(this,g)._++}reveal(){this.canBeRevealed&&(p(this,m,!0),this.onReveal.invoke(),this.canAutoRevealOthers&&this.adjacentTiles.filter(e=>e.canBeAutoRevealed).forEach(e=>e.reveal()))}}g=new WeakMap,m=new WeakMap,v=new WeakMap;function B(t){const e=document.createElement("div");return e.classList.add("tile"),e.classList.add("neighbours-"+t.adjacentMineCount.toString()),e.innerText=t.isMine?"ðŸ’£":t.adjacentMineCount==0?"":t.adjacentMineCount.toString(),e.addEventListener("click",n=>(n.preventDefault(),t.reveal(),!1)),e.addEventListener("contextmenu",n=>(n.preventDefault(),t.isFlagged=!t.isFlagged,!1)),t.onReveal.add(()=>{e.classList.add("revealed")}),t.onFlagStateChanged.add(()=>t.isFlagged?e.classList.add("flagged"):e.classList.remove("flagged")),e}function D(){const n=S(10,10,!1);for(let o=0;o<10;o++){const[u,d]=w(n,R=>!R);n[u][d]=!0}const a=O(n,o=>new T(o));F(a,(o,[u,d])=>{for(const R of b(a,u,d))o.addAdjacentTile(R)});let i=10*10-10;const s=()=>{document.body.classList.add("lost"),x()},r=()=>{i--,i<=0&&(document.body.classList.add("won"),x())};F(a,o=>o.onReveal.add(o.isMine?s:r));const M=document.createElement("div");M.classList.add("field");for(let o=0;o<a.length;o++){const u=document.createElement("div");for(let d=0;d<a[o].length;d++)u.appendChild(B(a[o][d]));M.appendChild(u)}document.querySelector("#app").appendChild(M)}D();function x(){setTimeout(()=>document.addEventListener("click",()=>window.location.reload()),10)}
